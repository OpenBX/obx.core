{
	"module": "obx.core",
	"namespace": "OBX\\Core\\DBSEntities",
	"class": "TestEntity",
	"class_path": "dbs_entity/DBSEntities/TestEntity.php",
	"name": {"ru": "Тестовая сущность", "en": "Entity for testing"},
	"version": "0.1.0",
	"main_table": "E",
	"events_id": "TestEntityRow",
	"get_list_fields": [
		{"name": "ID",			"table": "E", "field": "ID"},
		{"name": "CODE",		"table": "E", "field": "CODE"},
		{"name": "NAME",		"table": "E", "field": "NAME"},
		{"name": "SOME_BCHAR",	"table": "E", "field": "SOME_BCHAR"},
		{"name": "TIMESTAMP_X",	"table": "E", "field": "TIMESTAMP_X", "datetime"},
		{"name": "SOME_TEXT",	"table": "E", "field": "SOME_TEXT"},
		{"name": "IBLOCK_ID",	"table": "IB", "field": "ID"},
		{"name": "IBLOCK_CODE",	"table": "IB", "field": "CODE"},
		{"name": "IBLOCK_NAME",	"table": "IB", "field": "NAME"},
		{"name": "SEC_ENT_JSON","table": "S",
			"sub_query": "concat('[',group_concat(\
					'\"',S.ID, '\":', '\"',S.NAME, '\"'\
				),']')",
			"required_tables": ["S"],
			"required_group_by": ["E.ID"]
		},
		{"name": "SEC_ENT_CNT", "table": "S",
			"sub_query": "count(S.ID)",
			"sub_query_4_filter": "SELECT count(SE.ID)\
				FROM obx_core_test_sec_entity as SE\
				WHERE SE.TEST_ENTITY_ID = E.ID",
			"required_tables": ["S"]

		}
	],
	"group_by_default": ["E.ID"],
	"tables": [
		{
			"name": "obx_core_test_entity",
			"alias": "E",
			"fields": [
				{"name": "ID", "type": "int", "length": 11,
					"primary_key": true, "auto_increment": true,
					"null": false
				},
				{"name": "CODE", "type": "ident"},
				{"name": "NAME", "type": "string", "length": 255,
					"null": false, "required": true
				},
				{"name": "SOME_BCHAR", "type": "bchar",
					"null": false, "required": true, "default": "Y"
				},
				{"name": "TIMESTAMP_X", "type": "datetime"},
				{"name": "SOME_TEXT", "type": "text"},
				{"name": "IBLOCK_ID", "type": "int", "length": 11}
			],
			"create_table": true
		},
		{
			"name": "b_iblock",
			"alias": "IB",
			"create_table": false,
			"join": "link",
			"join_on": "E.IBLOCK_ID = IB.ID"
		},
		{
			"entity": "./SecondEntity.json",
			"alias": "S",
			"join": "left",
			"join_on": "E.ID = S.TEST_ENTITY_ID"
		}
	],
	"unique": [
		{"name": "obx_core_test_entity_code_bchar", "fields": ["CODE", "SOME_BCHAR"]}
	],
	"index": [
		{"name": "obx_core_test_entity_code", "fields": ["CODE"]}
	]
}